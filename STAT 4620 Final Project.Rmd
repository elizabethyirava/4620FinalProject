---
title: "STAT 4620 Project"
author: "Dominic Blackston"
date: "2024-11-22"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
```


# Read in dataset
```{r}
train = read.csv('train.csv')
test = read.csv('test.csv')
```

# EDA

### Data Cleaning

```{r}
train %>% 

  summarize(across(everything(), ~ sum(is.na(.)), .names = "missing_{.col}")) 

test %>% 

  summarize(across(everything(), ~ sum(is.na(.)), .names = "missing_{.col}")) 
```


157 rows are missing Metadata.Publishers in the train dataset; 107 rows are missing Metadata.Publishers in the test dataset.  After doing research, we found that many of the null columns had publishers that were already included in the dataset. After discussion, it was decided to eliminate this column due to its unreliability. There are also many time played columns that have missing values (0). These will be changed to median values.The summary function suggests no further changes need to be made to the data since there are no improbable outliers. The data appears to be accurate other than the aformentioned issues.

## Check for duplicated values
```{r}
training[!duplicated(training),]
```
There are no duplicate values.

```{r}
median_value_avg <- median(training_subset$Length.All.PlayStyles.Average[training_subset$Length.All.PlayStyles.Average != 0], na.rm = TRUE)

training_subset$Length.All.PlayStyles.Average[training_subset$Length.All.PlayStyles.Average == 0] = median_value_avg

median_value_leisure <- median(training_subset$Length.All.PlayStyles.Leisure[training_subset$Length.All.PlayStyles.Leisure != 0], na.rm = TRUE)

training_subset$Length.All.PlayStyles.Leisure[training_subset$Length.All.PlayStyles.Leisure == 0] = median_value_leisure

median_value_median <- median(training_subset$Length.All.PlayStyles.Median[training_subset$Length.All.PlayStyles.Median != 0], na.rm = TRUE)

training_subset$Length.All.PlayStyles.Median[training_subset$Length.All.PlayStyles.Median == 0] = median_value_median
```


```{r}
sum(is.na(training['']))
summary(training_subset)
```
The above suggests that there are no remanining null values. It also tells us that the data does not have any improbable outliers.

## Assessing collinearity
```{r}
corrmatrixtrain <- train %>%
  select(where(is.numeric)) %>%
  cor(use = "pairwise.complete.obs")
corrmatrixtest <- test %>%
  select(where(is.numeric)) %>%
  cor(use = "pairwise.complete.obs")

corrmatrixtrain[lower.tri(corrmatrixtrain)] <- NA
corrmatrixtest[lower.tri(corrmatrixtest)] <- NA

corrdftrain <- as.data.frame(as.table(corrmatrixtrain))
corrdftest <- as.data.frame(as.table(corrmatrixtest))

corrtrain80 <- corrdftrain %>%
  filter(Freq > 0.8 & Freq < 0.99999)
corrtest80 <- corrdftest %>%
  filter(Freq > 0.8 & Freq < 0.99999)

corrtrain80 %>%
  arrange(desc(Freq))
corrtest80 %>%
  arrange(desc(Freq))

head(corrtrain80, 5)
head(corrtest80, 5)
```
The numerical playlength variables we can see are highly correlated with one another, which is to be expected considering game design having shared underlying factors and tendencies of each player. 



```{r}
training_subset = training[c('Features.Handheld.', 'Features.Max.Players', 'Features.Multiplatform.', 'Features.Online.', 'Metadata.Genres', 'Metadata.Licensed.', 'Metadata.Publishers', 'Metadata.Sequel.', 'Metrics.Review.Score', 'Metrics.Sales','Metrics.Used.Price', 'Release.Console', 'Release.Rating', 'Release.Re.release.', 'Release.Year', 'Length.All.PlayStyles.Average', 'Length.All.PlayStyles.Leisure', 'Length.All.PlayStyles.Median')]
```
Values used in the models before further evaluation.



